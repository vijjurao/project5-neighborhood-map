function listClick(a){google.maps.event.trigger(markers[a],"click")}function init(){function a(a,c,f,g,h){function i(){return Math.floor(1e12*Math.random()).toString()}var j;this.name=ko.observable(c),this.lat=ko.observable(f),this.lng=ko.observable(g),this.id=ko.observable(h),this.marker=ko.observable(j);var k=new google.maps.LatLng(f,g);j=new google.maps.Marker({position:k,animation:google.maps.Animation.DROP,title:c,icon:"images/golf.png",map:a}),d.extend(k),j.addListener("click",b),YELP_KEY="0dt_RWZ_onDeRN_tx-JyhA",YELP_KEY_SECRET="fo8iIXS_u_TjOil8uMnNTm8LdEc",YELP_TOKEN="jRyu-QVU-IozwSQnZHW4u2U2Z0DVoGjd",YELP_TOKEN_SECRET="AyCSVZzGk-1kxF1I34unTYKw0vc";var l="http://api.yelp.com/v2/search",m={oauth_consumer_key:YELP_KEY,oauth_token:YELP_TOKEN,oauth_nonce:i(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",location:"Temecula",term:c,limit:1},n=oauthSignature.generate("GET",l,m,YELP_KEY_SECRET,YELP_TOKEN_SECRET);m.oauth_signature=n;var o={url:l,data:m,cache:!0,dataType:"jsonp",success:function(b){var c='<div style="float:left; width:60%;"><a href='+b.businesses[0].url+">"+b.businesses[0].name+'</a><br><img src="'+b.businesses[0].rating_img_url+'"/> '+b.businesses[0].review_count+" reviews<br><br>"+b.businesses[0].location.address+"<br>"+b.businesses[0].location.city+", "+b.businesses[0].location.state_code+" "+b.businesses[0].location.postal_code+'</div><div class="yelp-img" style="float:right; width:40%;"><img src="'+b.businesses[0].image_url+'"></div>';google.maps.event.addListener(j,"click",function(){for(var b=0;b<markers.length;b++)markers[b].setIcon("images/golf.png");this.setIcon("images/golfer.png"),e.setContent(c),e.open(a,j),a.panTo(k)})},error:function(){e.setErrorContent(contentString),e.open(a,j)}};$.ajax(o),this.isVisible=ko.observable(!1),this.isVisible.subscribe(function(b){b?j.setMap(a):j.setMap(null)}),this.isVisible(!0),markers.push(j)}function b(){var a=this;null!==a.getAnimation()?a.setAnimation(null):(a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},1400))}var c;c=new google.maps.Map(document.getElementById("map"),{center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.ROADMAP});var d=new google.maps.LatLngBounds,e=new google.maps.InfoWindow;c.fitBounds(d),google.maps.event.addListener(c,"click",function(){e.close()}),google.maps.event.addDomListener(window,"resize",function(){var a=c.getCenter();google.maps.event.trigger(c,"resize"),c.setCenter(a)});var f=function(){var b=this;b.pins=ko.observableArray([new a(c,"Journey At Pechanga",33.453157,-117.106526,0),new a(c,"Temecula Creek Inn",33.4676068,-117.1291816,1),new a(c,"The Golf Club at Rancho California",33.562563,-117.145126,2),new a(c,"Redhawk Golf Club",33.468955,-117.091304,3),new a(c,"The Legends Golf Club",33.51521,-117.113069,4),new a(c,"CrossCreek Golf Club",33.496457,-117.225794,5),new a(c,"Bear Creek Golf Club",33.582178,-117.262248,6),new a(c,"Fallbrook Golf Club",33.342399,-117.191919,7),new a(c,"Links at Summerly",33.649294,-117.306694,8),new a(c,"Diamond Valley Golf Club",33.66624,-116.958691,9)]),b.query=ko.observable(""),b.filterPins=ko.computed(function(){var a=b.query().toLowerCase();return ko.utils.arrayFilter(b.pins(),function(b){var c=b.name().toLowerCase().indexOf(a)>=0;return b.isVisible(c),c})})};ko.applyBindings(new f)}var markers=[];window.onload=init;